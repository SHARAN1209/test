Connection mockConn = mock(Connection.class);
DatabaseMetaData metaData = mock(DatabaseMetaData.class);
ResultSet columnRs = mock(ResultSet.class);
Statement stmt = mock(Statement.class);

when(dataSource.getConnection()).thenReturn(mockConn);
when(mockConn.getMetaData()).thenReturn(metaData);
when(metaData.getColumns(any(), any(), anyString(), any())).thenReturn(columnRs);

when(columnRs.next()).thenReturn(true, true, false);
when(columnRs.getString("COLUMN_NAME")).thenReturn("id", "name");
when(columnRs.getInt("NULLABLE")).thenReturn(DatabaseMetaData.columnNoNulls, DatabaseMetaData.columnNullable);

when(mockConn.createStatement()).thenReturn(stmt);
when(stmt.execute(anyString())).thenReturn(true);
